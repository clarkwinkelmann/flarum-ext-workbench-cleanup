(()=>{var n={n:e=>{var o=e&&e.__esModule?()=>e.default:()=>e;return n.d(o,{a:o}),o},d:(e,o)=>{for(var t in o)n.o(o,t)&&!n.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:o[t]})},o:(n,e)=>Object.prototype.hasOwnProperty.call(n,e),r:n=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})}},e={};(()=>{"use strict";n.r(e);const o=flarum.core.compat["admin/app"];var t=n.n(o);const r=flarum.core.compat["common/components/Button"];var a=n.n(r);const i=flarum.core.compat["common/components/LoadingIndicator"];var c=n.n(i);function l(n){return n>1e9?Math.round(n/1e9)+"GB":n>1e6?Math.round(n/1e6)+"MB":n>1e3?Math.round(n/1e3)+"kB":n+"B"}var s=function(){function n(){this.loading=!0,this.folders=null,this.cleaning=!1}var e=n.prototype;return e.refresh=function(){var n=this;this.loading=!0,this.folders=null,t().request({method:"POST",url:t().forum.attribute("apiUrl")+"/workbench-cleanup/inspect"}).then((function(e){n.folders=e,n.loading=!1,m.redraw()})).catch((function(e){throw n.loading=!1,m.redraw(),e}))},e.clean=function(n,e,o){var r=this;this.cleaning=!0,t().request({method:"POST",url:t().forum.attribute("apiUrl")+"/workbench-cleanup/clean",body:{folder:n,extension:e,type:o}}).then((function(){r.cleaning=!1,m.redraw()})).catch((function(n){throw r.cleaning=!1,m.redraw(),n}))},e.oninit=function(){this.refresh()},e.view=function(){var n=this;return[a().component({className:"Button",onclick:function(){n.refresh()},disabled:this.loading},"Refresh"),m(".WorkbenchCleanup",this.loading?c().component():this.list())]},e.list=function(){var n=this;return Array.isArray(this.folders)?0===this.folders.length?m("p","No workbench folders found"):this.folders.map((function(e){var o=Object.keys(e.extensions).sort();return[m("h3",e.path),m("table",[m("thead",m("tr",[m("th","Extension"),m("th",[a().component({className:"Button Button--icon",icon:"fas fa-eraser",onclick:function(){confirm("Delete all?")&&n.clean(e.path,"*","vendor")},loading:n.cleaning})," vendor"]),m("th",[a().component({className:"Button Button--icon",icon:"fas fa-eraser",onclick:function(){confirm("Delete all?")&&n.clean(e.path,"*","node_modules")},loading:n.cleaning})," node_modules"])])),m("tbody",o.map((function(o){var t=e.extensions[o],r=t.vendor,i=t.node_modules;return m("tr",[m("td",o),m("td",[a().component({className:"Button Button--icon",icon:"fas fa-eraser",onclick:function(){n.clean(e.path,o,"vendor")},loading:n.cleaning,disabled:!r})," ",r?l(r):m("em","Not found")]),m("td",[a().component({className:"Button Button--icon",icon:"fas fa-eraser",onclick:function(){n.clean(e.path,o,"node_modules")},loading:n.cleaning,disabled:!i})," ",i?l(i):m("em","Not found")])])})))])]})):m("p","An error occurred")},n}();t().initializers.add("clarkwinkelmann-workbench-cleanup",(function(){t().extensionData.for("clarkwinkelmann-workbench-cleanup").registerSetting((function(){return m(s)}))}))})(),module.exports=e})();
//# sourceMappingURL=admin.js.map